<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <!--Imposta non detraibile del 4% per la Cassa previdenziale dei professionisti-->
        <record id="tax_04_cpa_purchase" model="account.tax.template">
            <field name="description">CPA04</field>
            <field name="chart_template_id" ref="l10n_it_chart_template_marco"/>
            <field name="name">CPA 4% (Cassa Previdenziale Professionisti)</field>
            <field name="sequence">2</field>
            <field name="amount">4</field>
            <field name="amount_type">percent</field>
            <field name="type_tax_use">purchase</field>
            <field name="price_include">False</field>
            <field name="tax_group_id" ref="l10n_it_marco.tax_group_cpa_4"/>
            <field name="include_base_amount">True</field>


            <field name="invoice_repartition_line_ids" eval="[(5, 0, 0),
            (0, 0, {
                'repartition_type': 'base',
            }),
            (0, 0, {
                'repartition_type': 'tax',
                'factor_percent': 100,
            }),
        ]"/>


            <field name="refund_repartition_line_ids" eval="[(5, 0, 0),
            (0, 0, {
                'repartition_type': 'base',
            }),
            (0, 0, {
                'repartition_type': 'tax',
                'factor_percent': 100,
            }),
        ]"/>

        </record>
        <!--
        Gruppo che applica sia l'imposta al 4% della CPA sia l'IVA 22%, 
        le imposte nel gruppo vengono ordinate per sequence, importante che CPA4 abbia sequence inferiore a IVA 22%
        -->
        <record id="tax_tax_group_cpa_4" model="account.tax.template">
            <field name="sequence">1</field>
            <field name="chart_template_id" ref="l10n_it_chart_template_marco"/>
            <field name="name">CPA 4% + IVA 22% (Professionisti)</field>
            <field name="amount_type">group</field>
            <field name="type_tax_use">purchase</field>
            <field name="tax_group_id" ref="tax_group_cpa_4"/>
            <field name="children_tax_ids" eval="[(6, 0, [ref('tax_22_purchase'), ref('tax_04_cpa_purchase')])]"/>
        </record>

    </data>
</odoo>