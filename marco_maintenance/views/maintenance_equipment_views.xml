<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <record
    id="maintenance_equipment_view_form_inherit_marco_maintenance"
    model="ir.ui.view"
  >
    <field name="name"
      >maintenance.equipment.view.form.inherit.marco.maintenance</field
    >
    <field name="model">maintenance.equipment</field>
    <field name="inherit_id" ref="maintenance.hr_equipment_view_form" />
    <field name="arch" type="xml">
      <xpath expr="//div[@name='button_box']//button[1]" position="before">
        <field name="folder_exists" invisible="1" />
        <button
          name="action_view_documents"
          type="object"
          class="oe_stat_button"
          icon="fa-file-text"
          attrs="{'invisible':[('folder_exists','=',False)]}"
          string="Documents"
        >
          <field name="documents_count" widget="statinfo_websocket" />
        </button>
      </xpath>
      <!-- allow opening category from equipment -->
      <xpath expr="//field[@name='category_id']" position="attributes">
        <attribute name="options">{'no_open': False}</attribute>
      </xpath>
      <!-- move serial number -->
      <xpath expr="//field[@name='category_id']" position="before">
        <field name="serial_no" position="move" />
      </xpath>
      <xpath expr="//page[@name='maintenance']" position="attributes">
        <attribute name="invisible">1</attribute>
      </xpath>
      <xpath expr="//page[@name='maintenance']" position="after">
        <page
          string="Maintenance Request Templates"
          name="maintenance_request_templates"
        >
          <field
            nolabel="1"
            name="maintenance_request_template_ids"
            context="{'default_category_id': category_id, 'default_technician_user_id': technician_user_id, 'default_maintenance_team_id': maintenance_team_id}"
          >
            <tree editable="bottom" delete="1">
              <field name="name" />
              <field name="description" />
              <field name="request_name" />
              <field name="category_id" />
              <field name="equipment_ids_count_and_total" />
              <field name="start_date" />
              <field name="end_date" />
              <button
                name="open_template_form_view"
                type="object"
                string="Open"
                icon="fa-square-o pe-2"
              />
            </tree>
          </field>
        </page>
      </xpath>
    </field>
  </record>
</odoo>
